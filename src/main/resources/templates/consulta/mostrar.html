<!DOCTYPE html>
<html lang="pt-BR" layout:decorate="~{layout/layoutpadrao}" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>Mostrar Consultas</title>
</head>
<body>
    <main layout:fragment="conteudo" th:fragment="tabela" id="main" class="flex flex-col align-middle w-full m-10">
        <h1 class="text-xl md:text-2xl font-bold text-gray-800">Consultas Agendadas</h1>
        
        <div th:if="${notificacao != null}" th:object="${notificacao}">
            <input type="hidden" id="mensagemSA2" th:value="*{mensagem}">
            <input type="hidden" id="tipoSA2" th:value="*{tipo}">
            <input type="hidden" id="intervaloSA2" th:value="*{intervalo}">
        </div>

        <h1 th:if="${pagina.vazia}" class="text-lg md:text-xl mt-5 text-gray-500">Nenhuma consulta encontrada</h1>

        <div th:if="${not pagina.vazia}" class="flex flex-col mt-5">
            <div class="overflow-x-auto shadow-md rounded-xl">
                <div class="min-w-full inline-block align-middle">
                    <div class="border rounded-xl overflow-hidden shadow">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th th:replace="~{layout/fragments/paginacao :: coluna(${pagina}, 'codigo', 'Cód.', '')}"></th>
                                    <th th:replace="~{layout/fragments/paginacao :: coluna(${pagina}, 'data', 'Data', '')}"></th>
                                    <th th:replace="~{layout/fragments/paginacao :: coluna(${pagina}, 'horario', 'Horário', '')}"></th>
<<<<<<< HEAD
                                    <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase">Paciente</th>
                                    <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase">Médico</th>
                                    <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase">Status</th>
                                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase">Ação</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr th:each="consulta : ${pagina.conteudo}" class="odd:bg-white even:bg-gray-100 hover:bg-gray-200">
                                    <td th:text="${consulta.codigo}" class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800">1</td>
                                    <td th:text="${{consulta.data}}" class="px-6 py-4 whitespace-nowrap text-sm text-gray-800">01/01/2025</td>
                                    <td th:text="${consulta.horario}" class="px-6 py-4 whitespace-nowrap text-sm text-gray-800">14:00</td>
                                    <td th:text="${consulta.paciente.nome}" class="px-6 py-4 whitespace-nowrap text-sm text-gray-800">Paciente X</td>
                                    <td th:text="${consulta.medico.nome}" class="px-6 py-4 whitespace-nowrap text-sm text-gray-800">Dr. Y</td>
                                    <td th:text="${consulta.status}" class="px-6 py-4 whitespace-nowrap text-sm font-bold text-gray-800">AGENDADO</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-center">
                                        <div class="flex items-center justify-center gap-2">
                                            <a th:if="${consulta.status.name() == 'AGENDADO'}"
                                                th:href="@{/consulta/{codigo}/atender(codigo=${consulta.codigo})}"
                                                class="text-indigo-600 hover:text-indigo-900" title="Realizar Atendimento">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-clipboard-plus" viewBox="0 0 16 16">
                                                    <path fill-rule="evenodd" d="M8 7a.5.5 0 0 1 .5.5V9H10a.5.5 0 0 1 0 1H8.5v1.5a.5.5 0 0 1-1 0V10H6a.5.5 0 0 1 0-1h1.5V7.5A.5.5 0 0 1 8 7"/>
                                                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                                                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                                                </svg>
                                            </a>

                                            <form th:if="${consulta.status.name() == 'AGENDADO'}"
                                                th:action="@{/consulta/{codigo}/cancelar(codigo=${consulta.codigo})}"
                                                method="post"
                                                class="m-0"
                                                onsubmit="return confirm('Tem certeza que deseja cancelar este agendamento?');">
                                                
                                                <button type="submit" class="mt-1.5 text-red-600 hover:text-red-900 cursor-pointer" title="Cancelar Consulta">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-clipboard-x" viewBox="0 0 16 16">
                                                        <path fill-rule="evenodd" d="M6.146 7.146a.5.5 0 0 1 .708 0L8 8.293l1.146-1.147a.5.5 0 1 1 .708.708L8.707 9l1.147 1.146a.5.5 0 0 1-.708.708L8 9.707l-1.146 1.147a.5.5 0 0 1-.708-.708L7.293 9 6.146 7.854a.5.5 0 0 1 0-.708"/>
                                                        <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                                                        <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                                                    </svg>
                                                </button>
                                            </form>
                                        </div>

                                        <a th:if="${consulta.status.name() == 'FINALIZADO'}"
                                            th:href="@{/consulta/{codigo}/atender(codigo=${consulta.codigo})}"
                                            class="inline-flex items-center justify-center text-green-600 hover:text-green-900" title="Editar ou Ver Prontuário">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
                                                <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
                                                <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z"/>
                                            </svg>
                                        </a>
                                    </td>
=======
                                    
                                    <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase">Paciente</th>
                                    <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase">Médico</th>
                                    <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase">Status</th>
                                    
                                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase">Alterar</th>
                                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase">Atender</th>
                                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase">Excluir</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <tr th:each="consulta : ${pagina.conteudo}" class="hover:bg-gray-50 transition-colors">
                                    <td th:text="${consulta.codigo}" class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"></td>
                                    <td th:text="${{consulta.data}}" class="px-6 py-4 whitespace-nowrap text-sm text-gray-600"></td>
                                    <td th:text="${consulta.horario}" class="px-6 py-4 whitespace-nowrap text-sm text-gray-600"></td>
                                    <td th:text="${consulta.paciente.nome}" class="px-6 py-4 whitespace-nowrap text-sm text-gray-600"></td>
                                    <td th:text="${consulta.medico.nome}" class="px-6 py-4 whitespace-nowrap text-sm text-gray-600"></td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span th:text="${consulta.status}" 
                                              class="px-2 py-1 text-xs font-bold rounded-full bg-blue-100 text-blue-800"
                                              th:classappend="${consulta.status.name() == 'FINALIZADO' ? 'bg-green-100 text-green-800' : ''}">
                                        </span>
                                    </td>

                                    <td class="px-6 py-4 whitespace-nowrap text-center">
                                        <a th:if="${consulta.status.name() == 'AGENDADO'}"
                                           th:hx-get="@{/consulta/alterar/{codigo}(codigo=${consulta.codigo})}" 
                                           hx-target="#container-principal" 
                                           hx-swap="innerHTML"
                                           class="text-blue-600 hover:text-blue-900 cursor-pointer inline-flex items-center justify-center" 
                                           title="Alterar Agendamento">
                                           <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
                                              <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
                                              <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
                                            </svg>
                                        </a>
                                    </td>

                                    <td class="px-6 py-4 whitespace-nowrap text-center">
                                        <a th:if="${consulta.status.name() == 'AGENDADO'}"
                                            th:href="@{/consulta/{codigo}/atender(codigo=${consulta.codigo})}"
                                            class="inline-flex items-center gap-1 px-3 py-1 text-xs font-bold rounded-full border border-teal-500 text-teal-600 hover:bg-teal-50 transition-colors"
                                            title="Realizar Atendimento">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" class="bi bi-clipboard2-pulse" viewBox="0 0 16 16">
                                                <path d="M9.5 0a.5.5 0 0 1 .5.5.5.5 0 0 0 .5.5.5.5 0 0 1 .5.5V2a.5.5 0 0 1-.5.5h-5A.5.5 0 0 1 4 2v-.5a.5.5 0 0 1 .5-.5.5.5 0 0 0 .5-.5.5.5 0 0 1 .5-.5h3.5Z"/>
                                                <path d="M3 2.5a.5.5 0 0 1 .5-.5H4a.5.5 0 0 0 0-1h-.5A1.5 1.5 0 0 0 2 2.5v12A1.5 1.5 0 0 0 3.5 16h9a1.5 1.5 0 0 0 1.5-1.5v-12A1.5 1.5 0 0 0 12.5 1H12a.5.5 0 0 0 0 1h.5a.5.5 0 0 1 .5.5v12a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5v-12Z"/>
                                                <path d="M9.979 5.356a.5.5 0 0 0-.968.04L7.92 9.385l-.906-2.529a.5.5 0 0 0-.88-1.22l-1.42 2.13a.5.5 0 0 0 .832.554l.972-1.458.905 2.529a.5.5 0 0 0 .943.003l1.196-3.6 1.433 4.299a.5.5 0 0 0 .949-.316l-1.465-4.394Z"/>
                                            </svg>
                                            ATENDER
                                        </a>

                                        <a th:if="${consulta.status.name() == 'FINALIZADO'}"
                                            th:href="@{/consulta/{codigo}/atender(codigo=${consulta.codigo})}"
                                            class="text-green-600 hover:text-green-900 inline-flex items-center justify-center" 
                                            title="Ver Prontuário">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-file-earmark-text" viewBox="0 0 16 16">
                                                <path d="M5.5 7a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1h-5zM5 9.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5z"/>
                                                <path d="M9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.5L9.5 0zm0 1v2A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"/>
                                            </svg>
                                        </a>
                                    </td>

                                    <td class="px-6 py-4 whitespace-nowrap text-center">
                                        <form th:if="${consulta.status.name() == 'AGENDADO'}"
                                            th:action="@{/consulta/{codigo}/cancelar(codigo=${consulta.codigo})}"
                                            method="post"
                                            class="m-0 flex justify-center"
                                            onsubmit="return confirm('Tem certeza que deseja cancelar este agendamento?');">
                                            
                                            <button type="submit" class="text-red-600 hover:text-red-900 cursor-pointer" title="Cancelar Consulta">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-clipboard-x" viewBox="0 0 16 16">
                                                    <path fill-rule="evenodd" d="M6.146 7.146a.5.5 0 0 1 .708 0L8 8.293l1.146-1.147a.5.5 0 1 1 .708.708L8.707 9l1.147 1.146a.5.5 0 0 1-.708.708L8 9.707l-1.146 1.147a.5.5 0 0 1-.708-.708L7.293 9 6.146 7.854a.5.5 0 0 1 0-.708"/>
                                                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                                                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                                                </svg>
                                            </button>
                                        </form>
                                    </td>
>>>>>>> bfb3025 (Correção visuais e validações)
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div th:replace="~{layout/fragments/paginacao :: paginacao(${pagina})}"></div>
        </div>
    </main>
</body>
</html>